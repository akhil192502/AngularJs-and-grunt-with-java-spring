/*!
 * DemoProject - v0.0.0 - 2015-02-16
 * localhost
 * Copyright (c) 2015 Iotasol; Licensed 
*/
angular.module("common-directives",["common-services"]),angular.module("common-controllers",["ngResource","common-services"]),angular.module("common-services",[]),angular.module("common-filters",[]),angular.module("common-app",["ngResource","ngRoute","common-controllers","common-services","common-directives","common-filters","angularUtils.directives.dirPagination"]).config(["$routeProvider","$locationProvider","$httpProvider",function(a){a.when("/",{templateUrl:"/resources/angularjs/common/partials/index.html",controller:"ProductController"}).when("/about",{templateUrl:"/resources/angularjs/common/partials/about.html",controller:"AboutController"}).otherwise({redirectTo:"/"})}]).run(["$rootScope","$location","AuthenticationSharedService","Account",function(a,b,c,d){d.get({},function(b){a.user=b,a.authenticated=!0})}]);var commonControllers=angular.module("common-controllers");commonControllers.controller("ProductController",function(a,b,c,d,e){function f(){a.currentPage=1,a.product={},a.selectedCategoty={},a.categoryList=[{id:1,name:"Mobiles & Tablets"},{id:2,name:"Electronics & Computers"},{id:3,name:"Vehicles"},{id:4,name:"Home & Furniture"}],a.onClickValidation=!1,a.categoryError=!1,a.productList=[],e.fetchAll(function(b){a.productList=b})}f(),a.submitForm=function(b){a.onClickValidation=!b;var c=!1;b||(c=!0),angular.equals({},a.selectedCategoty)&&(a.categoryError=!0,c=!0),c||(a.product.categoryName=a.selectedCategoty,angular.isDefined(a.product.id)?e.update(a.product,function(){f()}):e.save(a.product,function(){f()}))},a.removeProduct=function(a){bootbox.dialog({message:"Are your sure to delete Product ?",title:"Confirm Box",buttons:{success:{label:"Yes",className:"btn-success",callback:function(){e.remove({id:a.id},function(){f()})}},danger:{label:"No",className:"btn-danger"}}})},a.editProduct=function(b){a.product=angular.copy(b),angular.forEach(a.categoryList,function(c){c.name==b.categoryName&&(a.selectedCategoty=c.name)})}}),commonControllers.controller("AboutController",function(){});var commonDirectives=angular.module("common-directives");commonDirectives.directive("loginPageDirective",function(){return{restrict:"EA",templateUrl:"/resources/angularjs/common/directives/templates/login-page-template.html",link:function(){},scope:{},controller:function(a,b,c,d){a.onClickValidate=!1,a.loginForm=!1,a.username="user",a.password="user",a.loginFunction=function(c){if(a.isError=!1,a.onClickValidate=!c,c){var e="j_username="+a.username.toLowerCase()+"&j_password="+a.password+"&_spring_security_remember_me=false&submit=Login";d.post("/app/authentication",e,{headers:{"Content-Type":"application/x-www-form-urlencoded"},ignoreAuthModule:"ignoreAuthModule"}).success(function(){window.location.href="/user"}).error(function(){a.data="Please use user as username and password for testing.",a.isError=!0,b(function(){a.isError=!1},5e3)})}}}}}),commonDirectives.directive("navBarDirective",function(){return{restrict:"EA",templateUrl:"/resources/angularjs/common/directives/templates/nav-bar-template.html",link:function(){},scope:{},controller:function(a,b,c,d,e){a.logoutFunction=function(){e.logout()}}}});var commonFilters=angular.module("common-filters"),commonServices=angular.module("common-services");commonServices.factory("AuthenticationSharedService",["$rootScope","$http",function(a,b){return{authenticate:function(){b.get("/api/user/authenticate").success(function(b){a.data=b,a.$broadcast(""==b.username?"event:auth-loginRequired":"event:auth-authConfirmed")})},logout:function(){b.get("/app/logout").success(function(){window.location.href="/"})}}}]),commonServices.factory("Account",function(a){return a("/api/user/account",{},{get:{method:"GET",params:{},isArray:!1}})}),commonServices.factory("ProductService",function(a){return a("/api/product/:id",{id:"@id"},{fetchAll:{method:"GET",params:{},isArray:!0},fetch:{method:"GET",params:{},isArray:!1},save:{method:"POST",params:{},isArray:!1},update:{method:"PUT",params:{},isArray:!1},remove:{method:"DELETE",params:{},isArray:!1}})});